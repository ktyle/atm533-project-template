{"version":"1","records":[{"hierarchy":{"lvl1":"ATM509: Atmospheric Precipitation Processes: Final Project"},"type":"lvl1","url":"/","position":0},{"hierarchy":{"lvl1":"ATM509: Atmospheric Precipitation Processes: Final Project"},"content":"","type":"content","url":"/","position":1},{"hierarchy":{"lvl1":"ATM509: Atmospheric Precipitation Processes: Final Project","lvl2":"Introduction and Motivation"},"type":"lvl2","url":"/#introduction-and-motivation","position":2},{"hierarchy":{"lvl1":"ATM509: Atmospheric Precipitation Processes: Final Project","lvl2":"Introduction and Motivation"},"content":"Heavy precipitation in the Northeast United States can be attributed to a wide variety of\nstorm types. \n\nHowarth et al. (2019) evaluated the seasonal trends of Northeast extreme precipitation\nevents and classified events as either “extratropical cyclone,” “convective,” “associated with tropical\nmoisture,” “hurricane/tropical storm,”, or “unidentified.” However, their study did not explicitly\naddress ARs. \n\nSlinskey et al. (2020) evaluated the precipitation and climatology of ARs in the\nNortheast U.S. National Climate Assessment Region and found that while ARs occur in all seasons\nacross the Northeast, they are most frequent in the fall (see \n\ntheir Fig. 2). \n\nHowarth et al. (2019) and\n\n\nSlinskey et al. (2020) both emphasize that although ARs can result in heavy precipitation events in\nthe Northeast, they are not the only meteorological phenomena responsible for them. This result\nlargely differs from the West Coast where more than 75% of the top-decile 24 h extreme\nprecipitation events in portions of northwestern California, Oregon, and Washington were associated\nwith ARs (\n\nRutz et al. (2014); \n\ntheir Fig. 11). This study therefore seeks to identify and classify extreme\nprecipitation events in the Northeast United States by their duration, type of weather phenomena,\nprecipitation rate, and AR association to build upon the previous literature.","type":"content","url":"/#introduction-and-motivation","position":3},{"hierarchy":{"lvl1":"ATM509: Atmospheric Precipitation Processes: Final Project","lvl2":"Methodology"},"type":"lvl2","url":"/#methodology","position":4},{"hierarchy":{"lvl1":"ATM509: Atmospheric Precipitation Processes: Final Project","lvl2":"Methodology"},"content":"For the purposes of this study, the Northeast United States was defined as Pennsylvania and\nNew Jersey northward. The time period was from 1 January 2002–31 December 2024. Gridded\nhourly precipitation data was obtained from the United States Geological Service (USGS) Stage-IV\nZarr Server. Stage-IV precipitation was chosen for this study due to its high resolution (available on a\n4 km by 4 km polar stereographic grid) and quality control from the thirteen National Weather\nService River Forecast Centers. As a result of the multi-sensor observations (e.g., rainfall gauge\nreports, mesonet observations, and doppler radar estimates) and human oversight, Stage-IV\nrepresents the highest resolution and most accurate dataset to use for this study.\n\nTo establish a definition of extreme precipitation, the 90th percentile of daily (0000–2300\nUTC) measurable precipitation (>0.254 mm) for every calendar month was calculated at every grid\npoint. From the Clausius–Clapeyron relationship, warmer temperatures result in greater moisture.\n\nConsidering precipitation efficiency (\n\nDoswell et al. (1996)), the heaviest precipitation rates would\nlikely occur in the summer when there is the most moisture. Furthermore, since TCs occur in the\nsummer and fall, one would expect the highest 90th percentile to occur during these months. Since\nthis study aims to investigate the influence of ARs in Northeast precipitation events, calculating the\n90th percentile as a function of month, rather than annually, was necessary to ensure that all\nwintertime AR events were captured.\n\nAn extreme precipitation event was defined when the 24 h rolling precipitation sum for a\ngiven grid point exceeded the monthly 90th percentile of daily precipitation (\n\nFigure 1) \n\nNotebook-code. Inspired by\n\n\nLamjiri et al. (2017), the start and end time of each event was defined by at least six consecutive\nhours of no precipitation. It is important to note that events where the 24 h rolling sum calculated\nfrom the start time of the event never exceeded the 90th percentile were discarded. This exclusion\noccurred when the rolling sum exceeded the 90th percentile from precipitation that occurred prior to\nthe six consecutive hours of dry conditions.\n\nFor each precipitation event identified, a precipitation mass centroid in time was calculated to\ndetermine the hour most representative of when the heaviest precipitation occurred. This mass\ncentroid approach was particularly useful for long duration events where the hourly precipitation was\nnon-uniform. \n\nFigure 2 provides an example event that occurred at the grid point closest to John F.\nKennedy Airport in New York City from 0000–1700 UTC 16 April 2018.\n\nFinally, to determine if an AR was present at the time of the centroid of the extreme\nprecipitation event, the Global Atmospheric Rivers Database Version 4 (\n\nGuan & Waliser (2024))\nwas utilized. Guan and Waliser identify an AR using a monthly IVT magnitude threshold and several\ngeometric considerations (e.g., the coherence of IVT and the length to aspect ratio). Since the AR\ndataset is six-hourly, the event centroids were rounded to the nearest six-hour mark, with times at the\nmidpoint (e.g., 0300 UTC and 0900 UTC) rounded down to the previous interval (e.g., 0000 and\n0600 UTC). This dataset was used to determine if an AR was present for a given event and to\ninvestigate the spatial extent and proximity of the AR relative to a grid point of interest.","type":"content","url":"/#methodology","position":5},{"hierarchy":{"lvl1":"ATM509: Atmospheric Precipitation Processes: Final Project","lvl2":"Results"},"type":"lvl2","url":"/#results","position":6},{"hierarchy":{"lvl1":"ATM509: Atmospheric Precipitation Processes: Final Project","lvl2":"Results"},"content":"The total number of extreme rainfall events across the domain was largely influenced by the\ntopography of the Northeast United States (\n\nFigure 3). The greatest number of events occurred in the\nhighest elevations of the Northeast, such as the Greens, Catskills, Adirondacks, Berkshires, and\nAppalachians, where 350–425 events were common. As a result of orographic precipitation\nprocesses, these locations had the greatest number of days with measurable precipitation, and thus\nthe highest number of cases. Areas prone to lake effect snow across western New York and the Tug\nHill Plateau had an even greater number of cases, between 475–500 events, where numerous days of\nmeasurable precipitation occurred in the winter.\n\nTo further understand the meteorological phenomena associated with extreme precipitation in\nthe Northeast, the events were stratified by month and duration (\n\nFigure 4). The lowest average event\ndurations, between 10–20 hours, occurred during the summer months from May–August. This result\nsuggests that summer extreme precipitation events are largely associated with atmospheric\nconvection, which is shorter-lived than extratropical cyclones. April appears to be a transition month\nbetween different atmospheric phenomena. In April, the event duration across much of the domain\nwas between 15–25 hours. By May, the average event duration was closer to 10–20 hours. This\nfinding implies that extratropical cyclones are the most common contributor to extreme precipitation\nin April and that convection begins to become more of a factor by May. Similarly, September is also\nunique as the event duration begins to increase following the summer months. While convection is\nstill expected to occur in September, TCs and extratropical cyclones associated with increased\nbaroclinicity could result in longer duration events. Finally, during the winter months, the average\nevent duration was longest. In particular, the lake effect snow regions have the longest average event\nduration in November, December, and January of greater than 30 hours.\n\nAnother way to visualize this data is to stratify the cases by duration, average precipitation\nrate, season, and AR association for an individual grid point, i.e., Albany, NY (\n\nFigure 5). For Albany,\nNY, there was a total of 358 events. While all seasons indicated a logarithmic relationship between\naverage hourly precipitation rate and event duration, this relationship was most pronounced in\nsummer. During the summer, atmospheric convection is the most dominant storm type. While often\nshort-lived, convection frequently produces heavy precipitation rates. In contrast, the longest\nduration events occurred in winter when extratropical cyclones are most common. These results are\nconsistent with \n\nFigure 4. Since the total event precipitation is a function of both the rate and duration of\nthe precipitation, the event total precipitation is similar across the seasons.\n\nHowever, the rate and duration of events vary depending on the dominant atmospheric phenomena,\nwhich themselves are seasonally dependent.\n\nAs for ARs, an event was said to be associated with an AR if an AR was detected at any grid\npoint within 1.5º of the Albany grid point. Events were most and least associated with ARs in the\nwinter and summer respectively (\n\nFigure 5 and \n\nFigure 6). While further work needs to be conducted, a\npreliminary hypothesis that may explain these results is that summer into early fall events are more\ndriven by convection and TCs, reducing the likelihood of association with ARs. Finally, one can\nvisualize the spatial extent of ARs as a function of season (\n\nFigure 7). For all rounded centroids at the\nAlbany grid point, ARs were most common during the winter throughout the entire domain. The\nlocation of the ARs were also skewed to the east of Albany, which was not a surprise since the closer\none gets to the water, the more frequent the ARs are.","type":"content","url":"/#results","position":7},{"hierarchy":{"lvl1":"ATM509: Atmospheric Precipitation Processes: Final Project","lvl2":"Concluding Summary"},"type":"lvl2","url":"/#concluding-summary","position":8},{"hierarchy":{"lvl1":"ATM509: Atmospheric Precipitation Processes: Final Project","lvl2":"Concluding Summary"},"content":"This study provides a comprehensive overview of the characteristics of extreme precipitation\nevents in the Northeast United States. The duration, precipitation rate, and atmospheric phenomena\nresponsible for the event were investigated throughout this study. Shorter duration but higher\nprecipitation intensity events were most frequent during the summer months and were likely\nassociated with atmospheric convection. Longer duration and lighter precipitation rate events\noccurred during the winter when extratropical cyclones are most common. The primary goal of this\nstudy was to evaluate the influence that ARs have in Northeast extreme precipitation events.\nPreliminary work found that ARs were most frequent in the winter months and to the east of Albany,\nNY. Further investigation of AR associated events needs to be conducted, such as stratifying events\nby integrated vapor transport magnitude and comparison to the West Coast.","type":"content","url":"/#concluding-summary","position":9},{"hierarchy":{"lvl1":"ATM509: Atmospheric Precipitation Processes: Final Project","lvl2":"Figures"},"type":"lvl2","url":"/#figures","position":10},{"hierarchy":{"lvl1":"ATM509: Atmospheric Precipitation Processes: Final Project","lvl2":"Figures"},"content":"\n\nFigure 1:Figure 1\n\n\n\nFigure 2:Figure 2\n\n\n\nFigure 3:Figure 3\n\n\n\nFigure 4:Figure 4\n\n\n\nFigure 5:Figure 5\n\n\n\nFigure 6:Figure 6\n\n\n\nFigure 7:Figure 7\n\n\n\nFigure 8:Slinsky et al. Fig 2\n\n\n\nFigure 9:Rutz et al. Fig. 11","type":"content","url":"/#figures","position":11},{"hierarchy":{"lvl1":"ATM 509 Final Project Figures - Evan Belkin"},"type":"lvl1","url":"/notebooks/plots","position":0},{"hierarchy":{"lvl1":"ATM 509 Final Project Figures - Evan Belkin"},"content":"","type":"content","url":"/notebooks/plots","position":1},{"hierarchy":{"lvl1":"ATM 509 Final Project Figures - Evan Belkin"},"type":"lvl1","url":"/notebooks/plots#atm-509-final-project-figures-evan-belkin","position":2},{"hierarchy":{"lvl1":"ATM 509 Final Project Figures - Evan Belkin"},"content":"\n\n","type":"content","url":"/notebooks/plots#atm-509-final-project-figures-evan-belkin","position":3},{"hierarchy":{"lvl1":"ATM 509 Final Project Figures - Evan Belkin","lvl2":"Imports"},"type":"lvl2","url":"/notebooks/plots#imports","position":4},{"hierarchy":{"lvl1":"ATM 509 Final Project Figures - Evan Belkin","lvl2":"Imports"},"content":"\n\nimport pandas as pd\nimport xarray as xr\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom metpy.plots import USCOUNTIES\nimport cartopy.crs as ccrs\nfrom scipy.interpolate import griddata\nimport cartopy.feature as cfeature\nfrom matplotlib.colors import ListedColormap, BoundaryNorm\nimport pickle \nimport cmweather\nimport matplotlib.dates as mdates\nfrom matplotlib.dates import DateFormatter, AutoDateLocator,HourLocator,DayLocator\nfrom matplotlib.ticker import FuncFormatter\nfrom herbie import Herbie\nfrom matplotlib.colors import Normalize\nfrom datetime import datetime, timedelta\n\n\n\n","type":"content","url":"/notebooks/plots#imports","position":5},{"hierarchy":{"lvl1":"ATM 509 Final Project Figures - Evan Belkin","lvl2":"Loading in Data:"},"type":"lvl2","url":"/notebooks/plots#loading-in-data","position":6},{"hierarchy":{"lvl1":"ATM 509 Final Project Figures - Evan Belkin","lvl2":"Loading in Data:"},"content":"\n\nmonthly_percentiles = pd.read_pickle(\"../data/509_Cases.pkl\")\n\n\n\n\n","type":"content","url":"/notebooks/plots#loading-in-data","position":7},{"hierarchy":{"lvl1":"ATM 509 Final Project Figures - Evan Belkin","lvl2":"Figure #1: Extract 90th percentile column and create a 4x3 plot."},"type":"lvl2","url":"/notebooks/plots#figure-1-extract-90th-percentile-column-and-create-a-4x3-plot","position":8},{"hierarchy":{"lvl1":"ATM 509 Final Project Figures - Evan Belkin","lvl2":"Figure #1: Extract 90th percentile column and create a 4x3 plot."},"content":"\n\ndef plot_lat_lon_12panel(dataframe):\n    # Define month names\n    month_names = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \n                   \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"]\n\n    # Ensure month column is integer for sorting\n    dataframe['Month'] = dataframe['Month'].astype(int)\n    months = sorted(dataframe['Month'].unique())\n\n    # Set up the figure with 12 subplots (4 rows x 3 columns)\n    fig, axes = plt.subplots(nrows=4, ncols=3, figsize=(20, 14),\n                             subplot_kw={'projection': ccrs.PlateCarree()},\n                             dpi=150)\n    axes = axes.flatten()\n\n    # Define fixed color bins\n    bounds = np.arange(5, 50, 5)\n    cmap = plt.get_cmap('NWSRef', len(bounds)-1) \n    norm = BoundaryNorm(bounds, cmap.N)\n\n    for i, month in enumerate(months):\n        ax = axes[i]\n        month_data = dataframe[dataframe['Month'] == month]\n\n        latitudes = month_data['center_lat'].values\n        longitudes = month_data['center_lon'].values\n        variable = month_data['90'].values    ## Extract 90th percentile! \n\n        ax.set_extent([-81, -67, 38.8, 48], crs=ccrs.PlateCarree()) \n\n        # Map features\n        ax.add_feature(cfeature.STATES, linestyle='--', linewidth=3)\n        ax.add_feature(cfeature.BORDERS, linestyle=':', linewidth=0.5)\n        ax.add_feature(cfeature.LAND, edgecolor='gray')\n        ax.add_feature(USCOUNTIES.with_scale('20m'), edgecolor='gray', linewidth=0.4)\n        \n        # Scatter plot with fixed color bins\n        sc = ax.scatter(longitudes, latitudes, c=variable, s=2,\n                        cmap=cmap, norm=norm, transform=ccrs.PlateCarree())\n\n        # Month label\n        ax.text(-76.5, 47.0, month_names[month-1],\n                fontsize=24, fontweight='bold',\n                transform=ccrs.PlateCarree(),\n                bbox=dict(facecolor='white', edgecolor='none', alpha=0.7))\n\n    # Add a shared colorbar\n    cbar_ax = fig.add_axes([0.92, 0.1, 0.015, 0.8])\n    cbar = fig.colorbar(sc, cax=cbar_ax, extend='both', ticks=bounds)\n    cbar.set_label('90th Percentile (mm)', fontsize=24)\n    cbar.ax.tick_params(labelsize=24)\n\n    # Layout\n    plt.suptitle(\"Monthly 90th Percentile of Measurable Precipitation\", fontsize=36)\n    plt.tight_layout(rect=[0, 0, 0.9, 1], pad=1.5, w_pad=0.3, h_pad=0.3)\n    #plt.savefig('evan.png')\n    plt.show()\n\nplot_lat_lon_12panel(monthly_percentiles)\n\n\n\n\n","type":"content","url":"/notebooks/plots#figure-1-extract-90th-percentile-column-and-create-a-4x3-plot","position":9},{"hierarchy":{"lvl1":"ATM 509 Final Project Figures - Evan Belkin","lvl2":"Figure #2: JFK Airport Example Event"},"type":"lvl2","url":"/notebooks/plots#figure-2-jfk-airport-example-event","position":10},{"hierarchy":{"lvl1":"ATM 509 Final Project Figures - Evan Belkin","lvl2":"Figure #2: JFK Airport Example Event"},"content":"\n\ntime_series = pd.read_pickle(\"../data/509_JFK.pkl\")\n\n\n\n\ndef custom_hour_formatter(x, pos):\n    dt = mdates.num2date(x)\n    if dt.hour == 0:\n        return dt.strftime('%H %d %b')  \n    else:\n        return dt.strftime('%H')     \n\nrolling_24h = time_series['24h_rolling_sum']\ntime = time_series['Datetime']\nprecipitation = time_series['Precipitation']\nevent_rolling24h = time_series['event_rolling_24h']\n\nfig, ax = plt.subplots(figsize=(14, 6))\n\nax.axhline(y=25.2380, c='red', alpha=0.7, linewidth=2, label='June 90th percentile')\n\nax.plot(time, rolling_24h, marker='o', linestyle='-', label='24 h rolling precip', color='b')\nax.plot(time, precipitation, marker='o', linestyle='-', label='Hourly precip', color='g')\n\nax.set_xlabel('Time (UTC)', fontsize=15)\nax.set_ylabel('Precip (mm)', fontsize=15)\n\nax.xaxis.set_major_locator(mdates.HourLocator(byhour=[0, 6, 12, 18]))\nax.xaxis.set_minor_locator(mdates.HourLocator(interval=1))\nax.xaxis.set_major_formatter(FuncFormatter(custom_hour_formatter))\n\n\nspecific_time = pd.Timestamp('2018-04-16 00:00:00')\nax.axvline(x=specific_time, color='purple', linewidth=5.0)\n\nspecific_time = pd.Timestamp('2018-04-16 05:00:00')\nax.axvline(x=specific_time, color='orange', linewidth=3.5, zorder=1)\n\nspecific_time = pd.Timestamp('2018-04-16 17:00:00')\nax.axvline(x=specific_time, color='purple', linewidth=5.0)\n\nplt.ylim(-1,80)\nax.tick_params(axis='x', pad=8, size=10) \nplt.xticks(fontsize=15)\nplt.yticks(fontsize=15)\nplt.grid()\n\n\n\n\n","type":"content","url":"/notebooks/plots#figure-2-jfk-airport-example-event","position":11},{"hierarchy":{"lvl1":"ATM 509 Final Project Figures - Evan Belkin","lvl2":"Figure #3A: Topography. Here is the code! Elev data is data from Herbie! :)"},"type":"lvl2","url":"/notebooks/plots#figure-3a-topography-here-is-the-code-elev-data-is-data-from-herbie","position":12},{"hierarchy":{"lvl1":"ATM 509 Final Project Figures - Evan Belkin","lvl2":"Figure #3A: Topography. Here is the code! Elev data is data from Herbie! :)"},"content":"\n\nH = Herbie(\n    date= datetime(2020, 12, 24, 6, 0, 0), # initialization date and time: year, month, day, hour, miunte, second\n    model=\"hrrr\",\n    product=\"sfc\",\n    fxx=6,\n)\n\nelev = H.xarray(':HGT:surface').orog\n\n\n\nfig = plt.figure(figsize=(10, 10), layout='constrained')\nax = fig.add_subplot(111, projection=ccrs.PlateCarree())\nax.set_title('Topography of the Northeast United States', fontsize=16)\n\nplot_bounds = [-81, -67, 38.8, 48]\nax.set_extent(plot_bounds)\n\n# Define levels using full 0–1200 scale\nlevels = np.arange(100, 1201, 50)\n\n# Mask values < 60 so they are not plotted\nmasked_elev = elev.where(elev >= 100)\n\nelev_cb = ax.contourf(\n    elev.longitude, elev.latitude, masked_elev,\n    levels=levels, cmap='gist_earth', extend='max'\n)\n\ncbar = plt.colorbar(\n    elev_cb, shrink=0.6,\n    ticks=np.arange(100, 1201, 300),\n    extend='max'\n)\ncbar.ax.tick_params(labelsize=12)\ncbar.set_label('Elevation (m)', fontsize=12)\nax.add_feature(cfeature.STATES, linestyle='--', linewidth=3)\n# Add county boundaries\n\n# Add red stars and labels\nax.plot(-73.7562, 42.6526, marker='*', color='red', markersize=15,\n        transform=ccrs.PlateCarree(), label='Albany, NY')\nax.plot(-75.85, 43.65, marker='*', color='red', markersize=15,\n        transform=ccrs.PlateCarree(), label='Tug Hill Plateau')\n\nax.text(-73.5562, 42.4526, 'Albany, NY', transform=ccrs.PlateCarree(),\n        fontsize=14, color='red', weight='bold')\nax.text(-75.65, 43.45, 'Tug Hill Plateau', transform=ccrs.PlateCarree(),\n        fontsize=14, color='red', weight='bold')\n\n\nplt.show()\n\n\n\n\n","type":"content","url":"/notebooks/plots#figure-3a-topography-here-is-the-code-elev-data-is-data-from-herbie","position":13},{"hierarchy":{"lvl1":"ATM 509 Final Project Figures - Evan Belkin","lvl2":"Figure #3B: Total # of Cases."},"type":"lvl2","url":"/notebooks/plots#figure-3b-total-of-cases","position":14},{"hierarchy":{"lvl1":"ATM 509 Final Project Figures - Evan Belkin","lvl2":"Figure #3B: Total # of Cases."},"content":"\n\nlatitudes = monthly_percentiles['center_lat'].values\nlongitudes = monthly_percentiles['center_lon'].values\ncases = monthly_percentiles['Cases'].values\n\n# Define bounds for discrete colorbar\nbounds = np.arange(250, 525, 25)  # 250–500 in steps of 25\ncmap = plt.get_cmap('NWSRef', len(bounds) - 1)\nnorm = plt.matplotlib.colors.BoundaryNorm(bounds, cmap.N)\n\n# Plot\nfig, ax = plt.subplots(figsize=(10, 8), subplot_kw={'projection': ccrs.PlateCarree()})\nax.set_extent([-81, -67, 38.8, 48], crs=ccrs.PlateCarree()) \n\nax.add_feature(cfeature.STATES, linestyle='--')\nax.add_feature(cfeature.BORDERS, linestyle=':')\nax.add_feature(cfeature.LAND, edgecolor='gray')\n\n# Counties (optional, if USCOUNTIES is available)\nax.add_feature(USCOUNTIES.with_scale('20m'), edgecolor='gray')\n\n# Scatter plot\nsc = ax.scatter(longitudes, latitudes, c=cases, s=1,\n                cmap=cmap, norm=norm, transform=ccrs.PlateCarree())\n\n# Colorbar with fixed bounds\ncbar = plt.colorbar(sc, ax=ax, boundaries=bounds, ticks=bounds,\n                    shrink=0.65, extend='max')\ncbar.set_label(\"Cases\")\n\nplt.title(\"Total Number of Cases\", fontsize=14)\nplt.show()\n\n\n\n\n","type":"content","url":"/notebooks/plots#figure-3b-total-of-cases","position":15},{"hierarchy":{"lvl1":"ATM 509 Final Project Figures - Evan Belkin","lvl2":"Figure #4: Event Duration by Month"},"type":"lvl2","url":"/notebooks/plots#figure-4-event-duration-by-month","position":16},{"hierarchy":{"lvl1":"ATM 509 Final Project Figures - Evan Belkin","lvl2":"Figure #4: Event Duration by Month"},"content":"\n\nduration = pd.read_pickle(\"../data/509_duration.pkl\")\n\n\n\n\nduration\n\n\n\ndef plot_lat_lon_12panel(dataframe):\n    # Define month names\n    month_names = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \n                   \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"]\n\n    # Ensure month column is integer for sorting\n    dataframe['month'] = dataframe['month'].astype(int)\n    months = sorted(dataframe['month'].unique())\n\n    # Set up the figure with 12 subplots (4 rows x 3 columns)\n    fig, axes = plt.subplots(nrows=4, ncols=3, figsize=(20, 14),\n                             subplot_kw={'projection': ccrs.PlateCarree()},\n                             dpi=150)\n    axes = axes.flatten()\n\n    # Define fixed color bins\n    bounds = np.arange(8, 40, 4)\n    cmap = plt.get_cmap('NWSRef', len(bounds)-1) \n    norm = BoundaryNorm(bounds, cmap.N)\n\n    for i, month in enumerate(months):\n        ax = axes[i]\n        month_data = dataframe[dataframe['month'] == month]\n\n        latitudes = month_data['center_lat'].values\n        longitudes = month_data['center_lon'].values\n        variable = month_data['duration'].values    ## Extract 90th percentile! \n\n        ax.set_extent([-81, -67, 38.8, 48], crs=ccrs.PlateCarree()) \n\n        # Map features\n        ax.add_feature(cfeature.STATES, linestyle='--', linewidth=3)\n        ax.add_feature(cfeature.BORDERS, linestyle=':', linewidth=0.5)\n        ax.add_feature(cfeature.LAND, edgecolor='gray')\n        ax.add_feature(USCOUNTIES.with_scale('20m'), edgecolor='gray', linewidth=0.4)\n        \n        # Scatter plot with fixed color bins\n        sc = ax.scatter(longitudes, latitudes, c=variable, s=2,\n                        cmap=cmap, norm=norm, transform=ccrs.PlateCarree())\n\n        # Month label\n        ax.text(-76.5, 47.0, month_names[month-1],\n                fontsize=24, fontweight='bold',\n                transform=ccrs.PlateCarree(),\n                bbox=dict(facecolor='white', edgecolor='none', alpha=0.7))\n\n    # Add a shared colorbar\n    cbar_ax = fig.add_axes([0.92, 0.1, 0.015, 0.8])\n    cbar = fig.colorbar(sc, cax=cbar_ax, extend='max', ticks=bounds)\n    cbar.set_label('Monthly Mean Event Duration (h)', fontsize=24)\n    cbar.ax.tick_params(labelsize=24)\n\n    # Layout\n    plt.suptitle(\"Monthly Mean Event Duration\", fontsize=36)\n    plt.tight_layout(rect=[0, 0, 0.9, 1], pad=1.5, w_pad=0.3, h_pad=0.3)\n    #plt.savefig('evan.png')\n    plt.show()\n\n\n\nplot_lat_lon_12panel(duration)\n\n\n\n\n","type":"content","url":"/notebooks/plots#figure-4-event-duration-by-month","position":17},{"hierarchy":{"lvl1":"ATM 509 Final Project Figures - Evan Belkin","lvl2":"Figure 5: Event Duration Plots"},"type":"lvl2","url":"/notebooks/plots#figure-5-event-duration-plots","position":18},{"hierarchy":{"lvl1":"ATM 509 Final Project Figures - Evan Belkin","lvl2":"Figure 5: Event Duration Plots"},"content":"\n\nfall = pd.read_pickle(\"../data/509_fall.pkl\")\nwinter = pd.read_pickle(\"../data/509_winter.pkl\")\nspring = pd.read_pickle(\"../data/509_spring.pkl\")\nsummer = pd.read_pickle(\"../data/509_summer.pkl\")\n\n\n\n\nfig, axes = plt.subplots(2, 2, figsize=(14, 10))\n\n# Font sizes\ntitle_fontsize = 18\nlabel_fontsize = 16\ntick_label_size = 14\nsupertitle_fontsize = 20\n\n# Define a helper function to plot each season\ndef plot_season(ax, data, title):\n    # Plot non-AR events in default color\n    non_ar = data[data['AR_association'] == False]\n    ax.scatter(non_ar['duration'], non_ar['avgrate_1h'], label='Non-AR', alpha=0.7)\n    \n    # Plot AR-associated events in red\n    ar = data[data['AR_association'] == True]\n    ax.scatter(ar['duration'], ar['avgrate_1h'], color='red', label='AR-associated', alpha=0.7)\n    \n    ax.set_xlabel('Event Duration', fontsize=label_fontsize)\n    ax.set_ylabel('Event Average 1 h Precip Rate', fontsize=label_fontsize)\n    ax.set_title(title, fontsize=title_fontsize)\n    ax.set_ylim(0, 20)\n    ax.set_xlim(0, 70)\n    ax.grid(True)\n    ax.legend(fontsize=12)\n    ax.tick_params(axis='both', labelsize=tick_label_size)\n\n# Plot each season\nplot_season(axes[0, 0], fall, 'FALL')\nplot_season(axes[0, 1], winter, 'WINTER')\nplot_season(axes[1, 0], spring, 'SPRING')\nplot_season(axes[1, 1], summer, 'SUMMER')\n\n# Set the main title\n\nfig.suptitle('Event Duration vs. Average 1 h Precipitation Rate by Season – Albany, NY',\n             fontsize=supertitle_fontsize)\n\n\n# Adjust layout\nplt.tight_layout(rect=[0, 0, 1, 0.95])\n\n# Show plot\nplt.show()\n\n\n\n\n","type":"content","url":"/notebooks/plots#figure-5-event-duration-plots","position":19},{"hierarchy":{"lvl1":"ATM 509 Final Project Figures - Evan Belkin","lvl2":"Figure 6: Seasonal Breakdown of Events:"},"type":"lvl2","url":"/notebooks/plots#figure-6-seasonal-breakdown-of-events","position":20},{"hierarchy":{"lvl1":"ATM 509 Final Project Figures - Evan Belkin","lvl2":"Figure 6: Seasonal Breakdown of Events:"},"content":"\n\nseasonal_stats = pd.read_pickle(\"../data/509_seasonal_stats.pkl\")\n\n\n\n\n# Calculate non-AR event counts\nnon_ar_count = seasonal_stats['Total_Count'] - seasonal_stats['True_Count']\n\n# Plot\nplt.figure(figsize=(10, 6))\nplt.bar(seasonal_stats.index, seasonal_stats['True_Count'], label='AR-Associated Events', color='orange')\nplt.bar(seasonal_stats.index, non_ar_count, bottom=seasonal_stats['True_Count'], label='Non-AR Events', color='steelblue')\n\n# Labels and formatting\nplt.xlabel('Season', fontsize=14)\nplt.ylabel('Number of Events', fontsize=14)\nplt.title(f'Seasonal Breakdown of Events – Albany, NY', fontsize=16)\nplt.xticks(fontsize=12)\nplt.yticks(fontsize=12)\nplt.legend(fontsize=12)\nplt.grid(axis='y')\nplt.ylim(0,150)\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n","type":"content","url":"/notebooks/plots#figure-6-seasonal-breakdown-of-events","position":21},{"hierarchy":{"lvl1":"ATM 509 Final Project Figures - Evan Belkin","lvl2":"Figure 7: AR Event Footprint"},"type":"lvl2","url":"/notebooks/plots#figure-7-ar-event-footprint","position":22},{"hierarchy":{"lvl1":"ATM 509 Final Project Figures - Evan Belkin","lvl2":"Figure 7: AR Event Footprint"},"content":"\n\npercent_AR_seasonal_df = pd.read_pickle(\"../data/509_percents.pkl\")\n\n\n\npoint_lon, point_lat = -73.819, 42.735   ###ALBANY\n\n\nseasons = ['DJF', 'MAM', 'JJA', 'SON']\nnorm = Normalize(vmin=10, vmax=80)\n\nfig, axs = plt.subplots(2, 2, figsize=(16, 12), subplot_kw={'projection': ccrs.PlateCarree()})\naxs = axs.flatten()\n\n# Loop over each season and plot\nfor i, season in enumerate(seasons):\n    ax = axs[i]\n    season_df = percent_AR_seasonal_df[percent_AR_seasonal_df['season'] == season]\n    \n    scatter = ax.scatter(\n        season_df['lon'],\n        season_df['lat'],\n        c=season_df['percent_AR'],\n        cmap='viridis',\n        norm=norm,\n        s=35,\n        transform=ccrs.PlateCarree()\n    )\n\n    ax.plot(\n        point_lon, point_lat,\n        marker='*',\n        color='red',\n        alpha=0.5,\n        markersize=12,\n        markeredgecolor='black',\n        transform=ccrs.PlateCarree(),\n        zorder=5\n    )\n\n    #ax.set_title(season, fontsize=18)\n    ax.text(-75.5, 46.2, season,\n        fontsize=24, fontweight='bold',\n        transform=ccrs.PlateCarree(),\n        bbox=dict(facecolor='white', edgecolor='none', alpha=0.7))\n    \n    ax.add_feature(cfeature.STATES, linestyle='--', edgecolor='black', linewidth=0.8)\n    ax.add_feature(cfeature.BORDERS, linestyle=':', edgecolor='black', linewidth=0.8)\n    ax.add_feature(cfeature.LAND, edgecolor='gray')  \n    ax.add_feature(USCOUNTIES.with_scale('20m'), edgecolor='gray', linewidth=0.5)\n\ncbar_ax = fig.add_axes([0.92, 0.15, 0.03, 0.8])  # [left, bottom, width, height]\ncbar = fig.colorbar(scatter, cax=cbar_ax, extend='both', label='% AR Events')\ncbar.set_label('% AR Events', fontsize=18)\ncbar.ax.tick_params(labelsize=18)  # Set tick labels' font size\n\n\n#fig.suptitle('Seasonal Percent of Events Associated with Atmospheric Rivers', fontsize=18)\n#fig.suptitle('Seasonal AR Frequency During Albany Extreme Precip Events', fontsize=18)\nfig.subplots_adjust(wspace=0.01, hspace=0.00001, right=0.9, top=0.92)  \n\nplt.show()\n\n\n","type":"content","url":"/notebooks/plots#figure-7-ar-event-footprint","position":23}]}